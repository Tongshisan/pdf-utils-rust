# é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
pdf-utils-rust/
â”‚
â”œâ”€â”€ .cargo/
â”‚   â””â”€â”€ config.toml              # Cargo æ„å»ºé…ç½®
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ build.yml            # GitHub Actions CI/CD é…ç½®
â”‚
â”œâ”€â”€ .vscode/
â”‚   â””â”€â”€ settings.json            # VS Code ç¼–è¾‘å™¨é…ç½®
â”‚
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ index.html               # Web æ¼”ç¤ºç¤ºä¾‹ï¼ˆå®Œæ•´çš„äº¤äº’ç•Œé¢ï¼‰
â”‚   â””â”€â”€ README.md                # ç¤ºä¾‹ä½¿ç”¨è¯´æ˜
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs                   # ä¸»åº“æ–‡ä»¶ï¼ŒWASM å…¥å£
â”‚   â”œâ”€â”€ pdf_utils.rs             # PDF å¤„ç†åŠŸèƒ½æ¨¡å—
â”‚   â””â”€â”€ image_utils.rs           # å›¾ç‰‡å¤„ç†åŠŸèƒ½æ¨¡å—
â”‚
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ integration_test.rs      # é›†æˆæµ‹è¯•
â”‚
â”œâ”€â”€ pkg/                         # æ„å»ºè¾“å‡ºç›®å½•ï¼ˆ.gitignoreï¼‰
â”‚   â”œâ”€â”€ web/                     # æµè§ˆå™¨ç‰ˆæœ¬
â”‚   â”œâ”€â”€ nodejs/                  # Node.js ç‰ˆæœ¬
â”‚   â””â”€â”€ bundler/                 # æ‰“åŒ…å·¥å…·ç‰ˆæœ¬
â”‚
â”œâ”€â”€ .gitignore                   # Git å¿½ç•¥é…ç½®
â”œâ”€â”€ build.sh                     # æ„å»ºè„šæœ¬ï¼ˆå¯æ‰§è¡Œï¼‰
â”œâ”€â”€ Cargo.toml                   # Rust é¡¹ç›®é…ç½®
â”œâ”€â”€ CONTRIBUTING.md              # è´¡çŒ®æŒ‡å—
â”œâ”€â”€ LICENSE                      # MIT è®¸å¯è¯
â”œâ”€â”€ package.json                 # NPM åŒ…é…ç½®
â”œâ”€â”€ PROJECT_STRUCTURE.md         # æœ¬æ–‡ä»¶
â”œâ”€â”€ QUICKSTART.md                # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”œâ”€â”€ README.md                    # é¡¹ç›®ä¸»æ–‡æ¡£ï¼ˆè‹±æ–‡ï¼‰
â”œâ”€â”€ rust-toolchain.toml          # Rust å·¥å…·é“¾é…ç½®
â””â”€â”€ USAGE_CN.md                  # è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼ˆä¸­æ–‡ï¼‰
```

## ğŸ“„ æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒæºä»£ç 

#### `src/lib.rs`

- **ä½œç”¨**: åº“çš„å…¥å£æ–‡ä»¶
- **åŠŸèƒ½**:
  - WASM åˆå§‹åŒ–
  - æ¨¡å—å¯¼å‡º
  - panic hook è®¾ç½®

#### `src/pdf_utils.rs`

- **ä½œç”¨**: PDF å¤„ç†åŠŸèƒ½æ¨¡å—
- **åŠŸèƒ½**:
  - `merge_pdfs()` - åˆå¹¶å¤šä¸ª PDF
  - `split_pdf()` - åˆ†å‰² PDF ä¸ºå•é¡µ
  - `split_pdf_by_range()` - æŒ‰èŒƒå›´åˆ†å‰² PDF
  - `get_pdf_page_count()` - è·å–é¡µæ•°

#### `src/image_utils.rs`

- **ä½œç”¨**: å›¾ç‰‡å¤„ç†åŠŸèƒ½æ¨¡å—
- **åŠŸèƒ½**:
  - `images_to_pdf()` - å›¾ç‰‡è½¬ PDF
  - `convert_image_format()` - æ ¼å¼è½¬æ¢
  - `resize_image()` - è°ƒæ•´å¤§å°
  - `compress_image()` - å‹ç¼©å›¾ç‰‡
  - `rotate_image()` - æ—‹è½¬å›¾ç‰‡
  - `crop_image()` - è£å‰ªå›¾ç‰‡
  - `get_image_info()` - è·å–å›¾ç‰‡ä¿¡æ¯

### é…ç½®æ–‡ä»¶

#### `Cargo.toml`

- **ä½œç”¨**: Rust é¡¹ç›®é…ç½®
- **å†…å®¹**:
  - é¡¹ç›®å…ƒæ•°æ®
  - ä¾èµ–å£°æ˜
  - æ„å»ºé…ç½®
  - ä¼˜åŒ–é…ç½®

#### `rust-toolchain.toml`

- **ä½œç”¨**: æŒ‡å®š Rust å·¥å…·é“¾ç‰ˆæœ¬
- **å†…å®¹**:
  - ä½¿ç”¨ stable ç‰ˆæœ¬
  - åŒ…å« rustfmt å’Œ clippy
  - æ·»åŠ  wasm32 ç›®æ ‡

#### `.cargo/config.toml`

- **ä½œç”¨**: Cargo æ„å»ºé…ç½®
- **å†…å®¹**:
  - é»˜è®¤ç¼–è¯‘ç›®æ ‡ä¸º wasm32
  - é“¾æ¥å™¨å‚æ•°ä¼˜åŒ–

#### `package.json`

- **ä½œç”¨**: NPM åŒ…é…ç½®
- **å†…å®¹**:
  - åŒ…å…ƒæ•°æ®
  - æ„å»ºè„šæœ¬
  - å‘å¸ƒé…ç½®

### æ„å»ºå’Œéƒ¨ç½²

#### `build.sh`

- **ä½œç”¨**: ä¸€é”®æ„å»ºè„šæœ¬
- **åŠŸèƒ½**:
  - æ£€æŸ¥ wasm-pack
  - æ„å»ºä¸‰ä¸ªç›®æ ‡ç‰ˆæœ¬
  - è¾“å‡ºæ„å»ºç»“æœ

#### `.github/workflows/build.yml`

- **ä½œç”¨**: CI/CD è‡ªåŠ¨åŒ–
- **åŠŸèƒ½**:
  - è‡ªåŠ¨æ„å»ºå’Œæµ‹è¯•
  - ç”Ÿæˆæ„ä»¶ä¸Šä¼ 

### æ–‡æ¡£

#### `README.md`

- **ä½œç”¨**: é¡¹ç›®ä¸»æ–‡æ¡£
- **å†…å®¹**:
  - åŠŸèƒ½ä»‹ç»
  - å¿«é€Ÿå¼€å§‹
  - API æ–‡æ¡£
  - ä½¿ç”¨ç¤ºä¾‹

#### `QUICKSTART.md`

- **ä½œç”¨**: å¿«é€Ÿå¼€å§‹æŒ‡å—
- **å†…å®¹**:
  - ç¯å¢ƒå®‰è£…
  - æ„å»ºæ­¥éª¤
  - å¸¸è§é—®é¢˜

#### `USAGE_CN.md`

- **ä½œç”¨**: è¯¦ç»†ä½¿ç”¨æŒ‡å—
- **å†…å®¹**:
  - å„ç§ä½¿ç”¨åœºæ™¯
  - ä»£ç ç¤ºä¾‹
  - æœ€ä½³å®è·µ

#### `CONTRIBUTING.md`

- **ä½œç”¨**: è´¡çŒ®æŒ‡å—
- **å†…å®¹**:
  - è´¡çŒ®æµç¨‹
  - ä»£ç è§„èŒƒ
  - æäº¤è§„èŒƒ

### ç¤ºä¾‹

#### `examples/index.html`

- **ä½œç”¨**: å®Œæ•´çš„ Web æ¼”ç¤º
- **åŠŸèƒ½**:
  - æ‰€æœ‰åŠŸèƒ½çš„äº¤äº’ç•Œé¢
  - ç¾è§‚çš„ UI è®¾è®¡
  - å®æ—¶å¤„ç†å’Œä¸‹è½½

## ğŸ”„ å·¥ä½œæµç¨‹

### å¼€å‘æµç¨‹

```
ç¼–å†™ä»£ç  â†’ æ ¼å¼åŒ– â†’ æ£€æŸ¥ â†’ æµ‹è¯• â†’ æ„å»º â†’ éƒ¨ç½²
   â†“         â†“        â†“      â†“      â†“       â†“
src/*.rs   cargo fmt  cargo  cargo  wasm-   pkg/
                      clippy test   pack
```

### æ„å»ºæµç¨‹

```
æºä»£ç  (src/)
    â†“
cargo build
    â†“
wasm-pack build
    â†“
WASM åŒ… (pkg/)
    â”œâ”€â”€ web/      (æµè§ˆå™¨)
    â”œâ”€â”€ nodejs/   (Node.js)
    â””â”€â”€ bundler/  (æ‰“åŒ…å·¥å…·)
```

### ä½¿ç”¨æµç¨‹

```
ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
    â†“
JavaScript è¯»å–æ–‡ä»¶
    â†“
è½¬æ¢ä¸º Uint8Array
    â†“
è°ƒç”¨ WASM å‡½æ•°
    â†“
Rust å¤„ç†æ•°æ®
    â†“
è¿”å›å¤„ç†ç»“æœ
    â†“
JavaScript æ¥æ”¶ç»“æœ
    â†“
è§¦å‘ä¸‹è½½æˆ–æ˜¾ç¤º
```

## ğŸ“¦ ä¾èµ–è¯´æ˜

### Rust ä¾èµ–

#### æ ¸å¿ƒä¾èµ–

- `wasm-bindgen` - Rust å’Œ JavaScript äº’æ“ä½œ
- `js-sys` - JavaScript æ ‡å‡†å¯¹è±¡ç»‘å®š
- `web-sys` - Web API ç»‘å®š

#### åŠŸèƒ½ä¾èµ–

- `lopdf` - PDF æ–‡ä»¶å¤„ç†
- `image` - å›¾ç‰‡å¤„ç†

#### è¾…åŠ©ä¾èµ–

- `serde` / `serde_json` - åºåˆ—åŒ–å’Œååºåˆ—åŒ–
- `console_error_panic_hook` - é”™è¯¯å¤„ç†

### å¼€å‘ä¾èµ–

- `wasm-bindgen-test` - WASM æµ‹è¯•æ¡†æ¶

## ğŸ¯ ç¼–è¯‘ç›®æ ‡

### wasm32-unknown-unknown

- **ç”¨é€”**: WebAssembly ç¼–è¯‘ç›®æ ‡
- **ç‰¹ç‚¹**:
  - æ— æ“ä½œç³»ç»Ÿä¾èµ–
  - è·¨å¹³å°
  - æµè§ˆå™¨å¯æ‰§è¡Œ

## ğŸ”§ æ‰©å±•å»ºè®®

### æ·»åŠ æ–°åŠŸèƒ½

1. **åˆ›å»ºæ–°æ¨¡å—**

   ```
   src/new_module.rs
   ```

2. **åœ¨ lib.rs ä¸­å¯¼å…¥**

   ```rust
   mod new_module;
   pub use new_module::*;
   ```

3. **å®ç°åŠŸèƒ½**

   ```rust
   #[wasm_bindgen]
   pub fn new_function(...) -> Result<...> {
       // å®ç°
   }
   ```

4. **æ›´æ–°æ–‡æ¡£**

   - README.md
   - API æ–‡æ¡£

5. **æ·»åŠ æµ‹è¯•**
   - å•å…ƒæµ‹è¯•
   - é›†æˆæµ‹è¯•

### ä¼˜åŒ–æ€§èƒ½

1. **ä½¿ç”¨ release æ„å»º**

   ```toml
   [profile.release]
   opt-level = "z"
   lto = true
   ```

2. **å‡å° WASM å¤§å°**

   - ä½¿ç”¨ wasm-opt
   - ç§»é™¤æœªä½¿ç”¨çš„ä¾èµ–
   - ä½¿ç”¨ features æ¡ä»¶ç¼–è¯‘

3. **ä¼˜åŒ–ç®—æ³•**
   - ä½¿ç”¨é«˜æ•ˆæ•°æ®ç»“æ„
   - å‡å°‘å†…å­˜åˆ†é…
   - å¹¶è¡Œå¤„ç†ï¼ˆå¦‚æœå¯èƒ½ï¼‰

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **æºä»£ç æ–‡ä»¶**: 3
- **æ–‡æ¡£æ–‡ä»¶**: 7
- **é…ç½®æ–‡ä»¶**: 5
- **ç¤ºä¾‹æ–‡ä»¶**: 2
- **æ€»ä»£ç è¡Œæ•°**: ~1000+ è¡Œ

## ğŸ“ å­¦ä¹ èµ„æº

### Rust

- [Rust å®˜æ–¹æ–‡æ¡£](https://doc.rust-lang.org/)
- [Rust By Example](https://doc.rust-lang.org/rust-by-example/)

### WebAssembly

- [WebAssembly å®˜ç½‘](https://webassembly.org/)
- [wasm-bindgen æ–‡æ¡£](https://rustwasm.github.io/wasm-bindgen/)

### ç›¸å…³åº“

- [lopdf æ–‡æ¡£](https://docs.rs/lopdf/)
- [image æ–‡æ¡£](https://docs.rs/image/)

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issueï¼
